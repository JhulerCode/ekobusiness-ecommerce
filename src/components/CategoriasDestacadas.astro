---
import { get, formatCategorias } from '../lib/api';

const qry = {
    fltr: {
        tipo: { op: 'Es', val: '2' },
        is_destacado: { op: 'Es', val: true },
    },
    cols: ['nombre', 'descripcion', 'fotos'],
    ordr: [['nombre', 'ASC']],
};
const res = await get('categorias', { qry });
const categorias = formatCategorias(res.data);
---

<section class="py-16 bg-gray-50">
    <div class="w-full px-4 md:px-6">
        <div class="text-center mb-12">
            <h2
                class="text-3xl md:text-4xl font-heading font-bold text-gray-900"
            >
                Categorías destacadas
            </h2>

            <p class="mt-2 text-gray-600">
                Explora nuestras secciones más populares y encuentra lo que
                buscas
            </p>
        </div>

        <div
            class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"
        >
            {
                categorias.map((cat, index) => (
                    <a
                        href={`/categoria/${cat.slug}`}
                        class={`group relative rounded-2xl overflow-hidden h-72 cursor-pointer transition block 
                        ${index < 2 ? 'lg:col-span-3' : 'lg:col-span-2'}`}
                    >
                        <!-- Imagen -->
                        <img
                            src={cat.foto}
                            alt={cat.nombre}
                            class="absolute inset-0 w-full h-full object-cover
                                transition-all duration-300"
                        />

                        <!-- Overlay para legibilidad -->
                        <div
                            class="absolute inset-0 
                                bg-black/30 group-hover:bg-black/50
                                transition-colors duration-300"
                        ></div>

                        <!-- Contenido -->
                        <div
                            class="relative z-10 h-full flex flex-col justify-end p-6"
                        >
                            <div
                                class="transition-transform duration-300"
                            >
                                <!-- Nombre -->
                                <h3
                                    class="text-2xl font-semibold text-white
                                        drop-shadow-lg
                                        transition-transform duration-300
                                        group-hover:-translate-y-2"
                                >
                                    {cat.nombre}
                                </h3>

                                <!-- Descripción -->
                                <p
                                    class="text-white text-sm mt-2
                                        opacity-0 translate-y-4
                                        h-0
                                        group-hover:opacity-100 group-hover:translate-y-0 group-hover:h-auto
                                        transition-all duration-300
                                        line-clamp-2 drop-shadow-md"
                                >
                                    {cat.descripcion}
                                </p>
                            </div>
                        </div>
                    </a>
                ))
            }
        </div>
    </div>
</section>
